<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>M2 Docker Demo Tutorial - Interstellar Book</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <!--<link rel="stylesheet" href="fonts/fonts.css"> 
        <!-- added additionally to include custom font CSS -->
        <link rel="stylesheet" href="its-theme/fonts/BF_Modernista.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="its-theme/fonts/BF_Modernista.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="GCF.html"><strong aria-hidden="true">1.</strong> Garbled Circuit Factory - GCF</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="GC.html"><strong aria-hidden="true">1.1.</strong> Garbled Circuit Overview</a></li><li class="chapter-item expanded "><a href="VC-GC.html"><strong aria-hidden="true">1.2.</strong> Visual Cryptography Display</a></li><li class="chapter-item expanded "><a href="GCF_pipeline_detailed.html"><strong aria-hidden="true">1.3.</strong> Detailed Pipeline for Display Circuits</a></li><li class="chapter-item expanded "><a href="GCF_API.html"><strong aria-hidden="true">1.4.</strong> Garbled Circuit Factory APIs</a></li></ol></li><li class="chapter-item expanded "><a href="TTVP.html"><strong aria-hidden="true">2.</strong> Trusted Transaction Validation Protocol</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="TAUI.html"><strong aria-hidden="true">2.1.</strong> Trusted Authentication & UI Layer</a></li><li class="chapter-item expanded "><a href="TTVP_detailed.html"><strong aria-hidden="true">2.2.</strong> TTVP detailed</a></li><li class="chapter-item expanded "><a href="TTVP-TEE.html"><strong aria-hidden="true">2.3.</strong> TTVP in Hardware Enclave-TEE</a></li></ol></li><li class="chapter-item expanded "><a href="Mobile_Registry.html"><strong aria-hidden="true">3.</strong> Mobile Registry</a></li><li class="chapter-item expanded "><a href="Mobile_App.html"><strong aria-hidden="true">4.</strong> Mobile Wallet App</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="TTVP_client.html"><strong aria-hidden="true">4.1.</strong> TTVP Client</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="HBMK.html"><strong aria-hidden="true">4.1.1.</strong> Hardware-backed Mobile Key</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="Testing.html"><strong aria-hidden="true">5.</strong> Testing Phase 1</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M1.html"><strong aria-hidden="true">5.1.</strong> M1 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M1_demo_tutorial.html"><strong aria-hidden="true">5.1.1.</strong> M1 Docker Demo Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="M2.html"><strong aria-hidden="true">5.2.</strong> M2 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M2_demo_tutorial.html" class="active"><strong aria-hidden="true">5.2.1.</strong> M2 Docker Demo Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="M3.html"><strong aria-hidden="true">5.3.</strong> M3 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M3_demo_tutorial.html"><strong aria-hidden="true">5.3.1.</strong> M3 Docker Demo Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="M4.html"><strong aria-hidden="true">5.4.</strong> M4 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M4_demo_tutorial.html"><strong aria-hidden="true">5.4.1.</strong> M4 Docker Demo Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="M5.html"><strong aria-hidden="true">5.5.</strong> M5 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="M5_demo_tutorial.html"><strong aria-hidden="true">5.5.1.</strong> M5 Docker Demo Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="Testing.html"><strong aria-hidden="true">5.6.</strong> Testing Phase 2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="2M1.html"><strong aria-hidden="true">5.6.1.</strong> M1 Delivery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="2M1_demo_tutorial.html"><strong aria-hidden="true">5.6.1.1.</strong> M1 Docker Demo Tutorial</a></li></ol></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Interstellar Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="m2-docker-demo-tutorial"><a class="header" href="#m2-docker-demo-tutorial">M2 Docker Demo Tutorial</a></h1>
<h2 id="check-prerequiste"><a class="header" href="#check-prerequiste">Check prerequiste</a></h2>
<p><a href="./runtime_prerequisite.html">runtime prerequiste</a></p>
<h2 id="set-up-demo"><a class="header" href="#set-up-demo">Set-up Demo</a></h2>
<h3 id="launch-ipfs-deamon"><a class="header" href="#launch-ipfs-deamon">Launch ipfs deamon</a></h3>
<pre><code class="language-sh">export GO_IPFS_PATH=/usr/local/bin/ipfs
</code></pre>
<pre><code class="language-sh">IPFS_PATH=/tmp/ipfs $GO_IPFS_PATH init -p test
</code></pre>
<pre><code class="language-sh">IPFS_PATH=/tmp/ipfs $GO_IPFS_PATH config Addresses.API /ip4/0.0.0.0/tcp/5001
</code></pre>
<pre><code class="language-sh">IPFS_PATH=/tmp/ipfs $GO_IPFS_PATH daemon --enable-pubsub-experiment
</code></pre>
<pre><code class="language-sh">Initializing daemon...
go-ipfs version: 0.11.0
Repo version: 11
System version: amd64/linux
Golang version: go1.16.12
Swarm listening on /ip4/127.0.0.1/tcp/46507
Swarm listening on /p2p-circuit
Swarm announcing /ip4/127.0.0.1/tcp/46507
API server listening on /ip4/0.0.0.0/tcp/5001
WebUI: http://0.0.0.0:5001/webui
Gateway (readonly) server listening on /ip4/127.0.0.1/tcp/38297
Daemon is ready
</code></pre>
<h3 id="launch-dockers"><a class="header" href="#launch-dockers">Launch dockers:</a></h3>
<blockquote>
<p>--ipfs-server-multiaddr value depends on your own environment
The example value should work with a standard docker installation.</p>
</blockquote>
<h4 id="launch-api_circuit-docker"><a class="header" href="#launch-api_circuit-docker">Launch api_circuit docker</a></h4>
<pre><code class="language-sh">docker run -it --name api_circuits --rm -p 3000:3000 --env RUST_LOG=&quot;warn,info,debug&quot; ghcr.io/interstellar-network/api_circuits:milestone2 /usr/local/bin/api_circuits --ipfs-server-multiaddr /ip4/172.17.0.1/tcp/5001
</code></pre>
<h4 id="launch-api_garble-docker"><a class="header" href="#launch-api_garble-docker">Launch api_garble docker</a></h4>
<pre><code class="language-sh">docker run -it --name api_garble --rm -p 3001:3000 --env RUST_LOG=&quot;warn,info,debug&quot; ghcr.io/interstellar-network/api_garble:milestone2 /usr/local/bin/api_garble --ipfs-server-multiaddr /ip4/172.17.0.1/tcp/5001
</code></pre>
<h3 id="launch-substrate-demo-chain-with-ocw"><a class="header" href="#launch-substrate-demo-chain-with-ocw">Launch substrate demo chain with OCW</a></h3>
<pre><code>git clone --branch=master --recursive git@github.com:Interstellar-Network/substrate-offchain-worker-demo.git
</code></pre>
<p>then</p>
<pre><code>cd substrate-offchain-worker-demo 
</code></pre>
<p>build and run the substrate chain....</p>
<pre><code class="language-sh">RUST_LOG=&quot;warn,info&quot; cargo run -- --dev --tmp --enable-offchain-indexing=1
</code></pre>
<blockquote>
<p>IMPORTANT: you MUST use --enable-offchain-indexing=1 else it will always do nothing and show &quot;[ocw-garble] nothing to do, returning...&quot; and &quot;[ocw-circuits] nothing to do, returning...&quot; in the logs</p>
</blockquote>
<h3 id="launch-a-generic-substrate-fromt-end"><a class="header" href="#launch-a-generic-substrate-fromt-end">Launch a generic Substrate Fromt-end</a></h3>
<p>Use the following <a href="https://substrate-developer-hub.github.io/substrate-front-end-template/?rpc=ws%3A%2F%2Flocalhost%3A9944">substrate link</a> to launch substrate front end</p>
<p>to connect to a locally running node</p>
<blockquote>
<p>avoid some browser extensions that could generate interface issues</p>
</blockquote>
<h2 id="demo-purpose-and-used-components"><a class="header" href="#demo-purpose-and-used-components">Demo purpose and used components</a></h2>
<p>In this demo, we want to demonstrate how:</p>
<ul>
<li>ocwCircuits and ocwGarble pallets can manage the production of the display garbled circuits </li>
<li>the Transaction Validation Protocol TTVP pallet can confirm the transactions based on those circuit evaluations/executions</li>
</ul>
<p><code>ocwCircuits</code>: can manage the generation of the logical display circuit in <code>skcd format</code> to configure the garbled circuit production.</p>
<blockquote>
<p>the generation of this configuration display circuit uses a Master File VHDL packages (pre-configured for that demo).</p>
</blockquote>
<p><code>ocwGarble</code>: can generate for each transaction a randomized display garbled circuit (with random Keypad and one time code) with a customized message based on transaction parameters</p>
<p><code>GCevaluator</code>: evaluates the garbled circuit/display message and get the one time code to verify</p>
<p><code>TTVP</code>: checks that the one time code is correct</p>
<h2 id="demo-overview"><a class="header" href="#demo-overview">Demo overview:</a></h2>
<h3 id="1-generate-with-ocwcircuits-pallet-the-configuration-display-circuit"><a class="header" href="#1-generate-with-ocwcircuits-pallet-the-configuration-display-circuit">1. Generate with <code>ocwCircuits</code> pallet the configuration display circuit</a></h3>
<blockquote>
<p>This step will generate a logical circuit in skcd format cached in memory in the production pipeline</p>
</blockquote>
<h3 id="2-generate-with-ocwgarble-pallet-a-randomized-display-garble-circuit"><a class="header" href="#2-generate-with-ocwgarble-pallet-a-randomized-display-garble-circuit">2. Generate with <code>ocwGarble</code> pallet a randomized display garble circuit</a></h3>
<blockquote>
<p>This step will use skcd cached file and input parameter to generate a randomized garbled circuit customized with transaction parameter
in this demo we do not use yet, other circuit customization parameters like screen resolution, etc...</p>
</blockquote>
<h3 id="3-evaluation-of-the-display-garbled-circuit-with-garbled-circuit-evaluator-to-display-transaction-message-and-one-time-code"><a class="header" href="#3-evaluation-of-the-display-garbled-circuit-with-garbled-circuit-evaluator-to-display-transaction-message-and-one-time-code">3. Evaluation of the display garbled circuit with <code>Garbled Circuit evaluator</code> to display transaction message and one time code</a></h3>
<h3 id="4-check-one-time-code-with-ttvp-pallet-ie-txvalidation"><a class="header" href="#4-check-one-time-code-with-ttvp-pallet-ie-txvalidation">4. Check one time code with <code>TTVP pallet</code> i.e txValidation</a></h3>
<h1 id="start-demo"><a class="header" href="#start-demo">Start Demo</a></h1>
<blockquote>
<p>IMPORTANT: when interacting with pallets you MUST use the Signed button in blue to sign all the transactions, not SUDO, neither Unsigned</p>
</blockquote>
<blockquote>
<p>step 1,2 &amp; 4 use pallet interactor in the Substrate Front End</p>
</blockquote>
<h2 id="1-generate-with-ocwcircuits-the-configuration-display-circuit"><a class="header" href="#1-generate-with-ocwcircuits-the-configuration-display-circuit">1. Generate with <code>ocwCircuits</code> the configuration display circuit</a></h2>
<h3 id="11--select-ocwcircuits-pallet-and-submitconfigdisplaysigned-extrinsic"><a class="header" href="#11--select-ocwcircuits-pallet-and-submitconfigdisplaysigned-extrinsic">1.1  Select ocwCircuits pallet and submitConfigDisplaySigned extrinsic</a></h3>
<p><img src="./fig/1ocwCircuitSelect.png" alt="circuit select" /></p>
<h3 id="12-sign-transaction"><a class="header" href="#12-sign-transaction">1.2 Sign transaction</a></h3>
<p><img src="./fig/2ocwCircuit.png" alt="circuit sign" /></p>
<h3 id="13-copy-the-ipfs-hashcid-of-the-generated-skcd-file"><a class="header" href="#13-copy-the-ipfs-hashcid-of-the-generated-skcd-file">1.3 Copy the ipfs hash/cid of the generated skcd file</a></h3>
<blockquote>
<p>the cid appears in Events (blue dot on this screenshot example)</p>
</blockquote>
<p><img src="./fig/3ocwCircuitResult.png" alt="circuit sign" /></p>
<h2 id="2-generate-with-ocwgarble-a-randomized-display-garble-circuit"><a class="header" href="#2-generate-with-ocwgarble-a-randomized-display-garble-circuit">2. Generate with <code>ocwGarble</code> a randomized display garble circuit</a></h2>
<p>This circuit can display a transaction message with one time code and a random keypad</p>
<h3 id="21-select-ocwgarble-pallet-and-garbleandstripsigned-extrinsic"><a class="header" href="#21-select-ocwgarble-pallet-and-garbleandstripsigned-extrinsic">2.1 Select ocwGarble pallet and garbleAndStripSigned extrinsic</a></h3>
<p><img src="./fig/1ocwGarbleSelect.png" alt="garble select" /></p>
<h3 id="22-input-skcdcid-and-transaction-message"><a class="header" href="#22-input-skcdcid-and-transaction-message">2.2 Input skcdCid and Transaction message</a></h3>
<p><img src="./fig/2ocwGarbleInput.png" alt="garble input 2 " /></p>
<h4 id="221-paste-the-ipfs-hashcid-of-step-13-in-field-skcdcid"><a class="header" href="#221-paste-the-ipfs-hashcid-of-step-13-in-field-skcdcid">2.2.1 Paste the ipfs hash/cid of step 1.3 in field skcdCid</a></h4>
<h4 id="222-input-the-message-in-field-txmsg"><a class="header" href="#222-input-the-message-in-field-txmsg">2.2.2 Input the message in field txMsg</a></h4>
<p><img src="./fig/3ocwGarbleInput.png" alt="garble input 3 " /></p>
<blockquote>
<p>the skcd cid is still in Events, blue dot in this example</p>
</blockquote>
<h4 id="223-sign-the-transaction"><a class="header" href="#223-sign-the-transaction">2.2.3 Sign the transaction</a></h4>
<h4 id="224-one-time-code-and-the-two-garbled-circuit-cids-appear-in-events"><a class="header" href="#224-one-time-code-and-the-two-garbled-circuit-cids-appear-in-events">2.2.4 One Time Code and the two garbled circuit cids appear in Events</a></h4>
<p><img src="./fig/4ocwGarbleResult.png" alt="garble result " /></p>
<p>The random One Time Code used for transaction validation appear in Events in the <code>txValidationDEBUGNewDigitSet</code> field (underlined with a red line in this screenshot example)</p>
<p>We can also check the random One Time Code securely embedded in the generated circuit in the api_garble logs and see that it matches the event mentioned field below.</p>
<p><img src="./fig/garble_log_OTC.png" alt="garble result ex " /></p>
<p>In this example the one time code value is 81 i.e. 0x0801 in Events and [8, 1] in api_garble logs.</p>
<blockquote>
<p>remark: it is important to mention that the number of digits used for transaction validation is not limited and can be easily configured (in upcoming TTVP APIs).</p>
</blockquote>
<p>The two generated garbled circuit cids to evaluate  appears in Events <code>NewGarbledIpfsCid</code>  (also underlined with red line)</p>
<p>In this example, the two respectives cids value are &quot;QmcXBLtfPxWVPgfQm6tnzcBg7KvzN7b9nNpVB4JPtHQEww&quot;,&quot;QmYKMiVWKKG5aYnHKp8shSVGLKCejv2jYCePZ6skkdaVhx&quot;</p>
<blockquote>
<p>matching respectively the pgarbled.pb.bin &amp; packmsg.pb.bin we will be evaluated on the next step</p>
</blockquote>
<h3 id="23-copy-the-hashs-of-the-two-generated-display-garbled-circuits-ready-to-be-avaluated"><a class="header" href="#23-copy-the-hashs-of-the-two-generated-display-garbled-circuits-ready-to-be-avaluated">2.3 Copy the hashs of the two generated display garbled circuits (ready to be avaluated)</a></h3>
<blockquote>
<p>remark: actually, the display circuit is composed of two subcircuits on for the display of transaction message and another which securely embed the one time code.</p>
</blockquote>
<blockquote>
<p>there is also another circuit that will display the random pinpad that we do not evaluate to make this demo simpler at this stage</p>
</blockquote>
<hr />
<blockquote>
<p>remark: you can specify any type of transaction message not especially tied to a wallet transaction. It can be used for any sensitive operation that need a highly secure confirmation</p>
</blockquote>
<p><img src="./fig/5ocwGarbleResult.png" alt="garble result ex " /></p>
<hr />
<h2 id="3-evaluation-of-the-display-garbled-circuits-with-the-evaluator-program-provided-in-a-docker"><a class="header" href="#3-evaluation-of-the-display-garbled-circuits-with-the-evaluator-program-provided-in-a-docker">3. Evaluation of the display garbled circuits with the evaluator program (provided in a docker)</a></h2>
<p>In this step we get the one time code to validate and check the transaction message</p>
<h3 id="31-first-create-a-folder-on-which-we-will-store-the-circuits"><a class="header" href="#31-first-create-a-folder-on-which-we-will-store-the-circuits">3.1 First create a folder on which we will store the circuits</a></h3>
<p>This folder will be mounted on the docker container to evaluate the two garbled circuits.</p>
<p>example:</p>
<pre><code class="language-sh">mkdir /tmp/evalcirc/
</code></pre>
<pre><code class="language-sh">cd /tmp/evalcirc/
</code></pre>
<blockquote>
<p>you can use any directory name, just pay attention that path is consistent with the following docker path parameters in step 3.2</p>
</blockquote>
<h3 id="32-create-the-garbled-circuits-in-the-above-folder"><a class="header" href="#32-create-the-garbled-circuits-in-the-above-folder">3.2 Create the garbled circuits in the above folder</a></h3>
<p>With the previously copied cids we then create respectively the <code>pgarbled.pb.bin</code> and <code>packmsg.pb.bin</code> garbled circuits files in the folder previously created to evaluate them with the evaluator.</p>
<pre><code class="language-sh">IPFS_PATH=/tmp/ipfs $GO_IPFS_PATH cat QmcXBLtfPxWVPgfQm6tnzcBg7KvzN7b9nNpVB4JPtHQEww &gt; pgarbled.pb.bin
</code></pre>
<pre><code>IPFS_PATH=/tmp/ipfs $GO_IPFS_PATH cat QmYKMiVWKKG5aYnHKp8shSVGLKCejv2jYCePZ6skkdaVhx &gt; packmsg.pb.bin
</code></pre>
<h3 id="32-launch-the-evaluator-in-docker"><a class="header" href="#32-launch-the-evaluator-in-docker">3.2 Launch the evaluator in docker</a></h3>
<p>We can now launch the docker with the parameter below to perform the circuit evaluation.</p>
<p>if the docker host can use X11 (i.e. WSL2 or VM):</p>
<pre><code class="language-sh">docker run -it --rm -v $(pwd):/data/ -v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=$DISPLAY ghcr.io/interstellar-network/lib_garble:milestone2 --pgarbled_input_path=/data/pgarbled.pb.bin --packmsg_input_path=/data/packmsg.pb.bin
</code></pre>
<p>wait and an X11 windows will pop-up and display both the transaction message and the one time code</p>
<p><img src="./fig/EvaluationResultX11.png" alt="garble result X11 " /></p>
<p>else: </p>
<pre><code class="language-sh">docker run -it --rm -v $(pwd):/data/ ghcr.io/interstellar-network/lib_garble:milestone2 --pgarbled_input_path=/data/pgarbled.pb.bin --packmsg_input_path=/data/packmsg.pb.bin --png_output_path=/data/output_eval.png
</code></pre>
<p>In this case an output_eval.png file will be genrerated by the evaluator</p>
<blockquote>
<p>/tmp/evalcirc is the folder previously created and mounted in the docker container</p>
</blockquote>
<pre><code class="language-sh">/tmp/evalcirc$ ls
output_eval.png  packmsg.pb.bin  pgarbled.pb.bin
</code></pre>
<blockquote>
<p>We can check that it matches both the inputted message  and the random one time code (securely embedded in the circuit) to be validated: <code>81</code> in this example.</p>
</blockquote>
<hr />
<blockquote>
<p>remark: this specific garbled circuit evaluator does not reflect the look and feel of the final version that will be use on mobile (and delivered with the next M3 milestone).
As the purpose of the demo is only to demonstrate a part of the Transaction validation protocol, this circuit resolution is minimal and does not manage the generation of the random visual cryptography frames.</p>
</blockquote>
<p>if you want to check what the final version look like use the following link: <a href="https://www.interstellar.gg/simulation">Transaction validation screen simulations</a></p>
<h2 id="4-check-one-time-code-with-ttvp-pallet-ie-txvalidation-1"><a class="header" href="#4-check-one-time-code-with-ttvp-pallet-ie-txvalidation-1">4. Check one time code with <code>TTVP pallet</code> i.e. <code>txValidation</code></a></h2>
<h3 id="41-select-txvalidation-pallet-and-checkinput-extrinsic"><a class="header" href="#41-select-txvalidation-pallet-and-checkinput-extrinsic">4.1 Select <code>txValidation</code> pallet and <code>checkInput</code> extrinsic</a></h3>
<h3 id="42-submit-the-one-time-code-to-the-pallet-to-validate-it"><a class="header" href="#42-submit-the-one-time-code-to-the-pallet-to-validate-it">4.2 Submit the one time code to the pallet to validate it</a></h3>
<h3 id="421-paste-the-cid-of-the-first-garbled-circuit-generated-in-ipfscid-field"><a class="header" href="#421-paste-the-cid-of-the-first-garbled-circuit-generated-in-ipfscid-field">4.2.1 Paste the cid of the first garbled circuit generated in <code>ipfsCid</code> field</a></h3>
<p>His value is <code>QmcXBLtfPxWVPgfQm6tnzcBg7KvzN7b9nNpVB4JPtHQEww</code> in our example. It matches the garble circuit i.e. <code>pgarbled.pb.bin</code> file that embed the one time code</p>
<h3 id="422-enter-the-code-you-read-in-the-previous-step-in-inputdigits-field"><a class="header" href="#422-enter-the-code-you-read-in-the-previous-step-in-inputdigits-field">4.2.2 Enter the code you read in the previous step in <code>inputDigits</code> field</a></h3>
<p>This is the two-digit code you read on the X11 pop-up or by displaying the <code>output_eval.png</code> image</p>
<h3 id="423-sign"><a class="header" href="#423-sign">4.2.3 Sign</a></h3>
<p><img src="./fig/txValOK.png" alt="check OK" /></p>
<h3 id="43-we-can-also-check-the-pallet-with-a-wrong-code"><a class="header" href="#43-we-can-also-check-the-pallet-with-a-wrong-code">4.3 We can also check the pallet with a wrong code</a></h3>
<p><img src="./fig/txValKO.png" alt="check KO" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="M2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="M3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="M2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="M3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
